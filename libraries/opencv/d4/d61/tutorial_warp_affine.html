<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>OpenCV: Affine Transformations</title>
<link href="../../opencv.ico" rel="shortcut icon" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../tutorial-utils.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  loader: {
    load: ['[tex]/ams']
  },
  tex: {
    macros: {},
    packages: ['base','configmacros','ams']
  }
};
//<![CDATA[
window.MathJax = {
    loader: {load: ['[tex]/ams']},
    tex: {
        packages: {'[+]': ['ams']},
        macros: {
            matTT: [ "\\[ \\left|\\begin{array}{ccc} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{array}\\right| \\]", 9],
            fork: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ \\end{array} \\right.", 4],
            forkthree: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ \\end{array} \\right.", 6],
            forkfour: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ #7 & \\mbox{#8}\\\\ \\end{array} \\right.", 8],
            vecthree: ["\\begin{bmatrix} #1\\\\ #2\\\\ #3 \\end{bmatrix}", 3],
            vecthreethree: ["\\begin{bmatrix} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{bmatrix}", 9],
            cameramatrix: ["#1 = \\begin{bmatrix} f_x & 0 & c_x\\\\ 0 & f_y & c_y\\\\ 0 & 0 & 1 \\end{bmatrix}", 1],
            distcoeffs: ["(k_1, k_2, p_1, p_2[, k_3[, k_4, k_5, k_6 [, s_1, s_2, s_3, s_4[, \\tau_x, \\tau_y]]]]) \\text{ of 4, 5, 8, 12 or 14 elements}"],
            distcoeffsfisheye: ["(k_1, k_2, k_3, k_4)"],
            hdotsfor: ["\\dots", 1],
            mathbbm: ["\\mathbb{#1}", 1],
            bordermatrix: ["\\matrix{#1}", 1]
        },
        processEscapes: false
    }
};
//]]>
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-chtml.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<!--#include virtual="/google-search.html"-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../opencv-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCV
   &#160;<span id="projectnumber">4.10.0</span>
   </div>
   <div id="projectbrief">Open Source Computer Vision</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/df8/tutorial_root.html">OpenCV Tutorials</a></li><li class="navelem"><a class="el" href="../../d7/da8/tutorial_table_of_content_imgproc.html">Image Processing (imgproc module)</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Affine Transformations</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md713">Goal</a></li>
<li class="level1"><a href="#autotoc_md714">Theory</a><ul><li class="level2"><a href="#autotoc_md715">What is an Affine Transformation?</a></li>
<li class="level2"><a href="#autotoc_md716">How do we get an Affine Transformation?</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md717">Code</a></li>
<li class="level1"><a href="#autotoc_md718">Explanation</a></li>
<li class="level1"><a href="#autotoc_md719">Result</a></li>
</ul>
</div>
<div class="textblock"><p><b>Prev Tutorial:</b> <a class="el" href="../../d1/da0/tutorial_remap.html">Remapping</a> <br  />
<b>Next Tutorial:</b> <a class="el" href="../../d4/d1b/tutorial_histogram_equalization.html">Histogram Equalization</a> <br  />
 </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight"></th><th class="markdownTableHeadLeft"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">Original author   </td><td class="markdownTableBodyLeft">Ana Huam√°n    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">Compatibility   </td><td class="markdownTableBodyLeft">OpenCV &gt;= 3.0   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md713"></a>
Goal</h1>
<p>In this tutorial you will learn how to:</p>
<ul>
<li>Use the OpenCV function <a class="el" href="../../da/d54/group__imgproc__transform.html#ga0203d9ee5fcd28d40dbc4a1ea4451983">cv::warpAffine</a> to implement simple remapping routines.</li>
<li>Use the OpenCV function <a class="el" href="../../da/d54/group__imgproc__transform.html#gafbbc470ce83812914a70abfb604f4326">cv::getRotationMatrix2D</a> to obtain a \(2 \times 3\) rotation matrix</li>
</ul>
<h1><a class="anchor" id="autotoc_md714"></a>
Theory</h1>
<h2><a class="anchor" id="autotoc_md715"></a>
What is an Affine Transformation?</h2>
<ol type="1">
<li>A transformation that can be expressed in the form of a <em>matrix multiplication</em> (linear transformation) followed by a <em>vector addition</em> (translation).</li>
<li><p class="startli">From the above, we can use an Affine Transformation to express:</p><ol type="a">
<li>Rotations (linear transformation)</li>
<li>Translations (vector addition)</li>
<li>Scale operations (linear transformation)</li>
</ol>
<p class="startli">you can see that, in essence, an Affine Transformation represents a <b>relation</b> between two images.</p>
</li>
<li>The usual way to represent an Affine Transformation is by using a \(2 \times 3\) matrix.</li>
</ol>
<p class="formulaDsp">
\[
    A = \begin{bmatrix}
        a_{00} &amp; a_{01} \\
        a_{10} &amp; a_{11}
        \end{bmatrix}_{2 \times 2}
    B = \begin{bmatrix}
        b_{00} \\
        b_{10}
        \end{bmatrix}_{2 \times 1}
    \]
</p>
  <p class="formulaDsp">
\[
    M = \begin{bmatrix}
        A &amp; B
        \end{bmatrix}
    =
   \begin{bmatrix}
        a_{00} &amp; a_{01} &amp; b_{00} \\
        a_{10} &amp; a_{11} &amp; b_{10}
   \end{bmatrix}_{2 \times 3}
   \]
</p>
<p>Considering that we want to transform a 2D vector \(X = \begin{bmatrix}x \\ y\end{bmatrix}\) by using \(A\) and \(B\), we can do the same with:</p>
<p>\(T = A \cdot \begin{bmatrix}x \\ y\end{bmatrix} + B\) or \(T = M \cdot  [x, y, 1]^{T}\)</p>
<p class="formulaDsp">
\[T =  \begin{bmatrix}
        a_{00}x + a_{01}y + b_{00} \\
        a_{10}x + a_{11}y + b_{10}
        \end{bmatrix}\]
</p>
<h2><a class="anchor" id="autotoc_md716"></a>
How do we get an Affine Transformation?</h2>
<ol type="1">
<li>We mentioned that an Affine Transformation is basically a <b>relation</b> between two images. The information about this relation can come, roughly, in two ways:<ol type="a">
<li>We know both \(X\) and T and we also know that they are related. Then our task is to find \(M\)</li>
<li>We know \(M\) and \(X\). To obtain \(T\) we only need to apply \(T = M \cdot X\). Our information for \(M\) may be explicit (i.e. have the 2-by-3 matrix) or it can come as a geometric relation between points.</li>
</ol>
</li>
<li>Let's explain this in a better way (b). Since \(M\) relates 2 images, we can analyze the simplest case in which it relates three points in both images. Look at the figure below:</li>
</ol>
<div class="image">
<img src="../../Warp_Affine_Tutorial_Theory_0.jpg" alt=""/>
</div>
    <p>the points 1, 2 and 3 (forming a triangle in image 1) are mapped into image 2, still forming a triangle, but now they have changed notoriously. If we find the Affine Transformation with these 3 points (you can choose them as you like), then we can apply this found relation to all the pixels in an image.</p>
<h1><a class="anchor" id="autotoc_md717"></a>
Code</h1>
<ul>
<li><b>What does this program do?</b><ul>
<li>Loads an image</li>
<li>Applies an Affine Transform to the image. This transform is obtained from the relation between three points. We use the function <a class="el" href="../../da/d54/group__imgproc__transform.html#ga0203d9ee5fcd28d40dbc4a1ea4451983">cv::warpAffine</a> for that purpose.</li>
<li>Applies a Rotation to the image after being transformed. This rotation is with respect to the image center</li>
<li>Waits until the user exits the program</li>
</ul>
</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'><ul>
<li>The tutorial's code is shown below. You can also download it <a href="https://raw.githubusercontent.com/opencv/opencv/4.x/samples/cpp/tutorial_code/ImgProc/Smoothing/Smoothing.cpp" target="_blank">here</a> <div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d87/imgcodecs_8hpp.html">opencv2/imgcodecs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d4/dd5/highgui_8hpp.html">opencv2/highgui.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d1/d4f/imgproc_2include_2opencv2_2imgproc_8hpp.html">opencv2/imgproc.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d2/d75/namespacecv.html">cv</a>;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv )</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_class" href="../../d0/d2e/classcv_1_1CommandLineParser.html">CommandLineParser</a> parser( argc, argv, <span class="stringliteral">&quot;{@input | lena.jpg | input image}&quot;</span> );</div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> src = imread( samples::findFile( parser.get&lt;<a class="code hl_typedef" href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">String</a>&gt;( <span class="stringliteral">&quot;@input&quot;</span> ) ) );</div>
<div class="line">    <span class="keywordflow">if</span>( src.<a class="code hl_function" href="../../d3/d63/classcv_1_1Mat.html#abbec3525a852e77998aba034813fded4">empty</a>() )</div>
<div class="line">    {</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Could not open or find the image!\n&quot;</span> &lt;&lt; endl;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; &lt;Input image&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> srcTri[3];</div>
<div class="line">    srcTri[0] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( 0.f, 0.f );</div>
<div class="line">    srcTri[1] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a> - 1.f, 0.f );</div>
<div class="line">    srcTri[2] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( 0.f, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a> - 1.f );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> dstTri[3];</div>
<div class="line">    dstTri[0] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( 0.f, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>*0.33f );</div>
<div class="line">    dstTri[1] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>*0.85f, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>*0.25f );</div>
<div class="line">    dstTri[2] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>*0.15f, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>*0.7f );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> warp_mat = getAffineTransform( srcTri, dstTri );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> warp_dst = Mat::zeros( src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>, src.<a class="code hl_function" href="../../d3/d63/classcv_1_1Mat.html#af2d2652e552d7de635988f18a84b53e5">type</a>() );</div>
<div class="line"> </div>
<div class="line">    warpAffine( src, warp_dst, warp_mat, warp_dst.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#a146f8e8dda07d1365a575ab83d9828d1">size</a>() );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point</a> center = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point</a>( warp_dst.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>/2, warp_dst.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>/2 );</div>
<div class="line">    <span class="keywordtype">double</span> angle = -50.0;</div>
<div class="line">    <span class="keywordtype">double</span> scale = 0.6;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> rot_mat = getRotationMatrix2D( center, angle, scale );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> warp_rotate_dst;</div>
<div class="line">    warpAffine( warp_dst, warp_rotate_dst, rot_mat, warp_dst.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#a146f8e8dda07d1365a575ab83d9828d1">size</a>() );</div>
<div class="line"> </div>
<div class="line">    imshow( <span class="stringliteral">&quot;Source image&quot;</span>, src );</div>
<div class="line">    imshow( <span class="stringliteral">&quot;Warp&quot;</span>, warp_dst );</div>
<div class="line">    imshow( <span class="stringliteral">&quot;Warp + Rotate&quot;</span>, warp_rotate_dst );</div>
<div class="line"> </div>
<div class="line">    waitKey();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclasscv_1_1CommandLineParser_html"><div class="ttname"><a href="../../d0/d2e/classcv_1_1CommandLineParser.html">cv::CommandLineParser</a></div><div class="ttdoc">Designed for command line parsing.</div><div class="ttdef"><b>Definition</b> utility.hpp:820</div></div>
<div class="ttc" id="aclasscv_1_1Mat_html"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a></div><div class="ttdoc">n-dimensional dense array class</div><div class="ttdef"><b>Definition</b> mat.hpp:812</div></div>
<div class="ttc" id="aclasscv_1_1Mat_html_a146f8e8dda07d1365a575ab83d9828d1"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html#a146f8e8dda07d1365a575ab83d9828d1">cv::Mat::size</a></div><div class="ttdeci">MatSize size</div><div class="ttdef"><b>Definition</b> mat.hpp:2160</div></div>
<div class="ttc" id="aclasscv_1_1Mat_html_aa3e5a47585c9ef6a0842556739155e3e"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cv::Mat::cols</a></div><div class="ttdeci">int cols</div><div class="ttdef"><b>Definition</b> mat.hpp:2138</div></div>
<div class="ttc" id="aclasscv_1_1Mat_html_abbec3525a852e77998aba034813fded4"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html#abbec3525a852e77998aba034813fded4">cv::Mat::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdoc">Returns true if the array has no elements.</div></div>
<div class="ttc" id="aclasscv_1_1Mat_html_abed816466c45234254d25bc59c31245e"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">cv::Mat::rows</a></div><div class="ttdeci">int rows</div><div class="ttdoc">the number of rows and columns or (-1, -1) when the matrix has more than 2 dimensions</div><div class="ttdef"><b>Definition</b> mat.hpp:2138</div></div>
<div class="ttc" id="aclasscv_1_1Mat_html_af2d2652e552d7de635988f18a84b53e5"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html#af2d2652e552d7de635988f18a84b53e5">cv::Mat::type</a></div><div class="ttdeci">int type() const</div><div class="ttdoc">Returns the type of a matrix element.</div></div>
<div class="ttc" id="aclasscv_1_1Point___html"><div class="ttname"><a href="../../db/d4e/classcv_1_1Point__.html">cv::Point_&lt; float &gt;</a></div></div>
<div class="ttc" id="agroup__core__basic_html_ga1f6634802eeadfd7245bc75cf3e216c2"><div class="ttname"><a href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">cv::String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition</b> cvstd.hpp:151</div></div>
<div class="ttc" id="ahighgui_8hpp_html"><div class="ttname"><a href="../../d4/dd5/highgui_8hpp.html">highgui.hpp</a></div></div>
<div class="ttc" id="ahighgui__qt_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> highgui_qt.cpp:3</div></div>
<div class="ttc" id="aimgcodecs_8hpp_html"><div class="ttname"><a href="../../d6/d87/imgcodecs_8hpp.html">imgcodecs.hpp</a></div></div>
<div class="ttc" id="aimgproc_2include_2opencv2_2imgproc_8hpp_html"><div class="ttname"><a href="../../d1/d4f/imgproc_2include_2opencv2_2imgproc_8hpp.html">imgproc.hpp</a></div></div>
<div class="ttc" id="anamespacecv_html"><div class="ttname"><a href="../../d2/d75/namespacecv.html">cv</a></div><div class="ttdoc">&quot;black box&quot; representation of the file storage associated with a file on disk.</div><div class="ttdef"><b>Definition</b> core.hpp:102</div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div><div class="ttdoc">STL namespace.</div></div>
</div><!-- fragment -->  </div> </li>
</ul>
 <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'><ul>
<li>The tutorial's code is shown below. You can also download it <a href="https://raw.githubusercontent.com/opencv/opencv/4.x/samples/cpp/tutorial_code/ImgProc/Smoothing/Smoothing.cpp" target="_blank">here</a> <div class="fragment"><div class="line"><span class="keyword">import</span> org.opencv.core.Core;</div>
<div class="line"><span class="keyword">import</span> org.opencv.core.Mat;</div>
<div class="line"><span class="keyword">import</span> org.opencv.core.MatOfPoint2f;</div>
<div class="line"><span class="keyword">import</span> org.opencv.core.Point;</div>
<div class="line"><span class="keyword">import</span> org.opencv.highgui.HighGui;</div>
<div class="line"><span class="keyword">import</span> org.opencv.imgcodecs.Imgcodecs;</div>
<div class="line"><span class="keyword">import</span> org.opencv.imgproc.Imgproc;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>GeometricTransforms {</div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> run(String[] args) {</div>
<div class="line">        String filename = args.length &gt; 0 ? args[0] : <span class="stringliteral">&quot;../data/lena.jpg&quot;</span>;</div>
<div class="line">        Mat src = Imgcodecs.imread(filename);</div>
<div class="line">        <span class="keywordflow">if</span> (src.empty()) {</div>
<div class="line">            System.err.println(<span class="stringliteral">&quot;Cannot read image: &quot;</span> + filename);</div>
<div class="line">            System.exit(0);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        Point[] srcTri = <span class="keyword">new</span> Point[3];</div>
<div class="line">        srcTri[0] = <span class="keyword">new</span> Point( 0, 0 );</div>
<div class="line">        srcTri[1] = <span class="keyword">new</span> Point( src.cols() - 1, 0 );</div>
<div class="line">        srcTri[2] = <span class="keyword">new</span> Point( 0, src.rows() - 1 );</div>
<div class="line"> </div>
<div class="line">        Point[] dstTri = <span class="keyword">new</span> Point[3];</div>
<div class="line">        dstTri[0] = <span class="keyword">new</span> Point( 0, src.rows()*0.33 );</div>
<div class="line">        dstTri[1] = <span class="keyword">new</span> Point( src.cols()*0.85, src.rows()*0.25 );</div>
<div class="line">        dstTri[2] = <span class="keyword">new</span> Point( src.cols()*0.15, src.rows()*0.7 );</div>
<div class="line"> </div>
<div class="line">        Mat warpMat = Imgproc.getAffineTransform( <span class="keyword">new</span> MatOfPoint2f(srcTri), <span class="keyword">new</span> MatOfPoint2f(dstTri) );</div>
<div class="line"> </div>
<div class="line">        Mat warpDst = Mat.zeros( src.rows(), src.cols(), src.type() );</div>
<div class="line"> </div>
<div class="line">        Imgproc.warpAffine( src, warpDst, warpMat, warpDst.size() );</div>
<div class="line"> </div>
<div class="line">        Point center = <span class="keyword">new</span> Point(warpDst.cols() / 2, warpDst.rows() / 2);</div>
<div class="line">        <span class="keywordtype">double</span> angle = -50.0;</div>
<div class="line">        <span class="keywordtype">double</span> scale = 0.6;</div>
<div class="line"> </div>
<div class="line">        Mat rotMat = Imgproc.getRotationMatrix2D( center, angle, scale );</div>
<div class="line"> </div>
<div class="line">        Mat warpRotateDst = <span class="keyword">new</span> Mat();</div>
<div class="line">        Imgproc.warpAffine( warpDst, warpRotateDst, rotMat, warpDst.size() );</div>
<div class="line"> </div>
<div class="line">        HighGui.imshow( <span class="stringliteral">&quot;Source image&quot;</span>, src );</div>
<div class="line">        HighGui.imshow( <span class="stringliteral">&quot;Warp&quot;</span>, warpDst );</div>
<div class="line">        HighGui.imshow( <span class="stringliteral">&quot;Warp + Rotate&quot;</span>, warpRotateDst );</div>
<div class="line"> </div>
<div class="line">        HighGui.waitKey(0);</div>
<div class="line"> </div>
<div class="line">        System.exit(0);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>GeometricTransformsDemo {</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(String[] args) {</div>
<div class="line">        <span class="comment">// Load the native OpenCV library</span></div>
<div class="line">        System.loadLibrary(Core.NATIVE_LIBRARY_NAME);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> GeometricTransforms().run(args);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->  </div> </li>
</ul>
 <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'><ul>
<li>The tutorial's code is shown below. You can also download it <a href="https://raw.githubusercontent.com/opencv/opencv/4.x/samples/python/tutorial_code/ImgTrans/warp_affine/Geometric_Transforms_Demo.py" target="_blank">here</a> <div class="fragment"><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</div>
<div class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</div>
<div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><span class="keyword">import</span> argparse</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">parser = argparse.ArgumentParser(description=<span class="stringliteral">&#39;Code for Affine Transformations tutorial.&#39;</span>)</div>
<div class="line">parser.add_argument(<span class="stringliteral">&#39;--input&#39;</span>, help=<span class="stringliteral">&#39;Path to input image.&#39;</span>, default=<span class="stringliteral">&#39;lena.jpg&#39;</span>)</div>
<div class="line">args = parser.parse_args()</div>
<div class="line"> </div>
<div class="line">src = <a class="code hl_function" href="../../d4/da8/group__imgcodecs.html#gab32ee19e22660912565f8140d0f675a8">cv.imread</a>(<a class="code hl_function" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">cv.samples.findFile</a>(args.input))</div>
<div class="line"><span class="keywordflow">if</span> src <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line">    print(<span class="stringliteral">&#39;Could not open or find the image:&#39;</span>, args.input)</div>
<div class="line">    exit(0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">srcTri = np.array( [[0, 0], [src.shape[1] - 1, 0], [0, src.shape[0] - 1]] ).astype(np.float32)</div>
<div class="line">dstTri = np.array( [[0, src.shape[1]*0.33], [src.shape[1]*0.85, src.shape[0]*0.25], [src.shape[1]*0.15, src.shape[0]*0.7]] ).astype(np.float32)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">warp_mat = <a class="code hl_function" href="../../da/d54/group__imgproc__transform.html#ga8f6d378f9f8eebb5cb55cd3ae295a999">cv.getAffineTransform</a>(srcTri, dstTri)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">warp_dst = <a class="code hl_function" href="../../da/d54/group__imgproc__transform.html#ga0203d9ee5fcd28d40dbc4a1ea4451983">cv.warpAffine</a>(src, warp_mat, (src.shape[1], src.shape[0]))</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"># Rotating the image after Warp</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">center = (warp_dst.shape[1]//2, warp_dst.shape[0]//2)</div>
<div class="line">angle = -50</div>
<div class="line">scale = 0.6</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">rot_mat = <a class="code hl_function" href="../../da/d54/group__imgproc__transform.html#gafbbc470ce83812914a70abfb604f4326">cv.getRotationMatrix2D</a>( center, angle, scale )</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">warp_rotate_dst = <a class="code hl_function" href="../../da/d54/group__imgproc__transform.html#ga0203d9ee5fcd28d40dbc4a1ea4451983">cv.warpAffine</a>(warp_dst, rot_mat, (warp_dst.shape[1], warp_dst.shape[0]))</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;Source image&#39;</span>, src)</div>
<div class="line"><a class="code hl_function" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;Warp&#39;</span>, warp_dst)</div>
<div class="line"><a class="code hl_function" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;Warp + Rotate&#39;</span>, warp_rotate_dst)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">cv.waitKey</a>()</div>
<div class="line"> </div>
<div class="ttc" id="agroup__core__utils__samples_html_ga3a33b00033b46c698ff6340d95569c13"><div class="ttname"><a href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">cv::samples::findFile</a></div><div class="ttdeci">cv::String findFile(const cv::String &amp;relative_path, bool required=true, bool silentMode=false)</div><div class="ttdoc">Try to find requested data file.</div></div>
<div class="ttc" id="agroup__highgui_html_ga453d42fe4cb60e5723281a89973ee563"><div class="ttname"><a href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv::imshow</a></div><div class="ttdeci">void imshow(const String &amp;winname, InputArray mat)</div><div class="ttdoc">Displays an image in the specified window.</div></div>
<div class="ttc" id="agroup__highgui_html_ga5628525ad33f52eab17feebcfba38bd7"><div class="ttname"><a href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">cv::waitKey</a></div><div class="ttdeci">int waitKey(int delay=0)</div><div class="ttdoc">Waits for a pressed key.</div></div>
<div class="ttc" id="agroup__imgcodecs_html_gab32ee19e22660912565f8140d0f675a8"><div class="ttname"><a href="../../d4/da8/group__imgcodecs.html#gab32ee19e22660912565f8140d0f675a8">cv::imread</a></div><div class="ttdeci">CV_EXPORTS_W Mat imread(const String &amp;filename, int flags=IMREAD_COLOR)</div><div class="ttdoc">Loads an image from a file.</div></div>
<div class="ttc" id="agroup__imgproc__transform_html_ga0203d9ee5fcd28d40dbc4a1ea4451983"><div class="ttname"><a href="../../da/d54/group__imgproc__transform.html#ga0203d9ee5fcd28d40dbc4a1ea4451983">cv::warpAffine</a></div><div class="ttdeci">void warpAffine(InputArray src, OutputArray dst, InputArray M, Size dsize, int flags=INTER_LINEAR, int borderMode=BORDER_CONSTANT, const Scalar &amp;borderValue=Scalar())</div><div class="ttdoc">Applies an affine transformation to an image.</div></div>
<div class="ttc" id="agroup__imgproc__transform_html_ga8f6d378f9f8eebb5cb55cd3ae295a999"><div class="ttname"><a href="../../da/d54/group__imgproc__transform.html#ga8f6d378f9f8eebb5cb55cd3ae295a999">cv::getAffineTransform</a></div><div class="ttdeci">Mat getAffineTransform(const Point2f src[], const Point2f dst[])</div><div class="ttdoc">Calculates an affine transform from three pairs of the corresponding points.</div></div>
<div class="ttc" id="agroup__imgproc__transform_html_gafbbc470ce83812914a70abfb604f4326"><div class="ttname"><a href="../../da/d54/group__imgproc__transform.html#gafbbc470ce83812914a70abfb604f4326">cv::getRotationMatrix2D</a></div><div class="ttdeci">Mat getRotationMatrix2D(Point2f center, double angle, double scale)</div><div class="ttdoc">Calculates an affine matrix of 2D rotation.</div><div class="ttdef"><b>Definition</b> imgproc.hpp:2582</div></div>
</div><!-- fragment -->  </div> </li>
</ul>
<h1><a class="anchor" id="autotoc_md718"></a>
Explanation</h1>
<ul>
<li><p class="startli">Load an image:</p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code hl_class" href="../../d0/d2e/classcv_1_1CommandLineParser.html">CommandLineParser</a> parser( argc, argv, <span class="stringliteral">&quot;{@input | lena.jpg | input image}&quot;</span> );</div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> src = imread( samples::findFile( parser.get&lt;<a class="code hl_typedef" href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">String</a>&gt;( <span class="stringliteral">&quot;@input&quot;</span> ) ) );</div>
<div class="line">    <span class="keywordflow">if</span>( src.<a class="code hl_function" href="../../d3/d63/classcv_1_1Mat.html#abbec3525a852e77998aba034813fded4">empty</a>() )</div>
<div class="line">    {</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Could not open or find the image!\n&quot;</span> &lt;&lt; endl;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; &lt;Input image&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        String filename = args.length &gt; 0 ? args[0] : <span class="stringliteral">&quot;../data/lena.jpg&quot;</span>;</div>
<div class="line">        Mat src = Imgcodecs.imread(filename);</div>
<div class="line">        <span class="keywordflow">if</span> (src.empty()) {</div>
<div class="line">            System.err.println(<span class="stringliteral">&quot;Cannot read image: &quot;</span> + filename);</div>
<div class="line">            System.exit(0);</div>
<div class="line">        }</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">parser = argparse.ArgumentParser(description=<span class="stringliteral">&#39;Code for Affine Transformations tutorial.&#39;</span>)</div>
<div class="line">parser.add_argument(<span class="stringliteral">&#39;--input&#39;</span>, help=<span class="stringliteral">&#39;Path to input image.&#39;</span>, default=<span class="stringliteral">&#39;lena.jpg&#39;</span>)</div>
<div class="line">args = parser.parse_args()</div>
<div class="line"> </div>
<div class="line">src = <a class="code hl_function" href="../../d4/da8/group__imgcodecs.html#gab32ee19e22660912565f8140d0f675a8">cv.imread</a>(<a class="code hl_function" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">cv.samples.findFile</a>(args.input))</div>
<div class="line"><span class="keywordflow">if</span> src <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line">    print(<span class="stringliteral">&#39;Could not open or find the image:&#39;</span>, args.input)</div>
<div class="line">    exit(0)</div>
</div><!-- fragment -->  </div> </li>
<li><p class="startli"><b>Affine Transform:</b> As we explained in lines above, we need two sets of 3 points to derive the affine transform relation. Have a look:</p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> srcTri[3];</div>
<div class="line">    srcTri[0] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( 0.f, 0.f );</div>
<div class="line">    srcTri[1] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a> - 1.f, 0.f );</div>
<div class="line">    srcTri[2] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( 0.f, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a> - 1.f );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> dstTri[3];</div>
<div class="line">    dstTri[0] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( 0.f, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>*0.33f );</div>
<div class="line">    dstTri[1] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>*0.85f, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>*0.25f );</div>
<div class="line">    dstTri[2] = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>( src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>*0.15f, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>*0.7f );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Point[] srcTri = <span class="keyword">new</span> Point[3];</div>
<div class="line">        srcTri[0] = <span class="keyword">new</span> Point( 0, 0 );</div>
<div class="line">        srcTri[1] = <span class="keyword">new</span> Point( src.cols() - 1, 0 );</div>
<div class="line">        srcTri[2] = <span class="keyword">new</span> Point( 0, src.rows() - 1 );</div>
<div class="line"> </div>
<div class="line">        Point[] dstTri = <span class="keyword">new</span> Point[3];</div>
<div class="line">        dstTri[0] = <span class="keyword">new</span> Point( 0, src.rows()*0.33 );</div>
<div class="line">        dstTri[1] = <span class="keyword">new</span> Point( src.cols()*0.85, src.rows()*0.25 );</div>
<div class="line">        dstTri[2] = <span class="keyword">new</span> Point( src.cols()*0.15, src.rows()*0.7 );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">srcTri = np.array( [[0, 0], [src.shape[1] - 1, 0], [0, src.shape[0] - 1]] ).astype(np.float32)</div>
<div class="line">dstTri = np.array( [[0, src.shape[1]*0.33], [src.shape[1]*0.85, src.shape[0]*0.25], [src.shape[1]*0.15, src.shape[0]*0.7]] ).astype(np.float32)</div>
</div><!-- fragment -->  </div> <p> You may want to draw these points to get a better idea on how they change. Their locations are approximately the same as the ones depicted in the example figure (in the Theory section). You may note that the size and orientation of the triangle defined by the 3 points change.</p>
</li>
<li><p class="startli">Armed with both sets of points, we calculate the Affine Transform by using OpenCV function <a class="el" href="../../da/d54/group__imgproc__transform.html#ga8f6d378f9f8eebb5cb55cd3ae295a999">cv::getAffineTransform</a> :</p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> warp_mat = getAffineTransform( srcTri, dstTri );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Mat warpMat = Imgproc.getAffineTransform( <span class="keyword">new</span> MatOfPoint2f(srcTri), <span class="keyword">new</span> MatOfPoint2f(dstTri) );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">warp_mat = <a class="code hl_function" href="../../da/d54/group__imgproc__transform.html#ga8f6d378f9f8eebb5cb55cd3ae295a999">cv.getAffineTransform</a>(srcTri, dstTri)</div>
</div><!-- fragment -->  </div> <p> We get a \(2 \times 3\) matrix as an output (in this case <b>warp_mat</b>)</p>
</li>
<li><p class="startli">We then apply the Affine Transform just found to the src image</p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> warp_dst = Mat::zeros( src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>, src.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>, src.<a class="code hl_function" href="../../d3/d63/classcv_1_1Mat.html#af2d2652e552d7de635988f18a84b53e5">type</a>() );</div>
<div class="line"> </div>
<div class="line">    warpAffine( src, warp_dst, warp_mat, warp_dst.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#a146f8e8dda07d1365a575ab83d9828d1">size</a>() );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Mat warpDst = Mat.zeros( src.rows(), src.cols(), src.type() );</div>
<div class="line"> </div>
<div class="line">        Imgproc.warpAffine( src, warpDst, warpMat, warpDst.size() );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">warp_dst = <a class="code hl_function" href="../../da/d54/group__imgproc__transform.html#ga0203d9ee5fcd28d40dbc4a1ea4451983">cv.warpAffine</a>(src, warp_mat, (src.shape[1], src.shape[0]))</div>
</div><!-- fragment -->  </div> <p> with the following arguments:</p><ul>
<li><b>src</b>: Input image</li>
<li><b>warp_dst</b>: Output image</li>
<li><b>warp_mat</b>: Affine transform</li>
<li><b>warp_dst.size()</b>: The desired size of the output image</li>
</ul>
<p class="startli">We just got our first transformed image! We will display it in one bit. Before that, we also want to rotate it...</p>
</li>
<li><p class="startli"><b>Rotate:</b> To rotate an image, we need to know two things:</p><ol type="1">
<li>The center with respect to which the image will rotate</li>
<li>The angle to be rotated. In OpenCV a positive angle is counter-clockwise</li>
<li><em>Optional:</em> A scale factor</li>
</ol>
<p class="startli">We define these parameters with the following snippet:</p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point</a> center = <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point</a>( warp_dst.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>/2, warp_dst.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>/2 );</div>
<div class="line">    <span class="keywordtype">double</span> angle = -50.0;</div>
<div class="line">    <span class="keywordtype">double</span> scale = 0.6;</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Point center = <span class="keyword">new</span> Point(warpDst.cols() / 2, warpDst.rows() / 2);</div>
<div class="line">        <span class="keywordtype">double</span> angle = -50.0;</div>
<div class="line">        <span class="keywordtype">double</span> scale = 0.6;</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">center = (warp_dst.shape[1]//2, warp_dst.shape[0]//2)</div>
<div class="line">angle = -50</div>
<div class="line">scale = 0.6</div>
</div><!-- fragment -->  </div> </li>
<li><p class="startli">We generate the rotation matrix with the OpenCV function <a class="el" href="../../da/d54/group__imgproc__transform.html#gafbbc470ce83812914a70abfb604f4326">cv::getRotationMatrix2D</a> , which returns a \(2 \times 3\) matrix (in this case <em>rot_mat</em>)</p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> rot_mat = getRotationMatrix2D( center, angle, scale );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Mat rotMat = Imgproc.getRotationMatrix2D( center, angle, scale );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">rot_mat = <a class="code hl_function" href="../../da/d54/group__imgproc__transform.html#gafbbc470ce83812914a70abfb604f4326">cv.getRotationMatrix2D</a>( center, angle, scale )</div>
</div><!-- fragment -->  </div> </li>
<li><p class="startli">We now apply the found rotation to the output of our previous Transformation:</p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> warp_rotate_dst;</div>
<div class="line">    warpAffine( warp_dst, warp_rotate_dst, rot_mat, warp_dst.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#a146f8e8dda07d1365a575ab83d9828d1">size</a>() );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Mat warpRotateDst = <span class="keyword">new</span> Mat();</div>
<div class="line">        Imgproc.warpAffine( warpDst, warpRotateDst, rotMat, warpDst.size() );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">warp_rotate_dst = <a class="code hl_function" href="../../da/d54/group__imgproc__transform.html#ga0203d9ee5fcd28d40dbc4a1ea4451983">cv.warpAffine</a>(warp_dst, rot_mat, (warp_dst.shape[1], warp_dst.shape[0]))</div>
</div><!-- fragment -->  </div> </li>
<li><p class="startli">Finally, we display our results in two windows plus the original image for good measure:</p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    imshow( <span class="stringliteral">&quot;Source image&quot;</span>, src );</div>
<div class="line">    imshow( <span class="stringliteral">&quot;Warp&quot;</span>, warp_dst );</div>
<div class="line">    imshow( <span class="stringliteral">&quot;Warp + Rotate&quot;</span>, warp_rotate_dst );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        HighGui.imshow( <span class="stringliteral">&quot;Source image&quot;</span>, src );</div>
<div class="line">        HighGui.imshow( <span class="stringliteral">&quot;Warp&quot;</span>, warpDst );</div>
<div class="line">        HighGui.imshow( <span class="stringliteral">&quot;Warp + Rotate&quot;</span>, warpRotateDst );</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line"><a class="code hl_function" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;Source image&#39;</span>, src)</div>
<div class="line"><a class="code hl_function" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;Warp&#39;</span>, warp_dst)</div>
<div class="line"><a class="code hl_function" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;Warp + Rotate&#39;</span>, warp_rotate_dst)</div>
</div><!-- fragment -->  </div> </li>
<li><p class="startli">We just have to wait until the user exits the program</p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    waitKey();</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        HighGui.waitKey(0);</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line"><a class="code hl_function" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">cv.waitKey</a>()</div>
</div><!-- fragment -->  </div> </li>
</ul>
<h1><a class="anchor" id="autotoc_md719"></a>
Result</h1>
<ul>
<li>After compiling the code above, we can give it the path of an image as argument. For instance, for a picture like:</li>
</ul>
<div class="image">
<img src="../../Warp_Affine_Tutorial_Original_Image.jpg" alt=""/>
</div>
    <p>after applying the first Affine Transform we obtain:</p>
<div class="image">
<img src="../../Warp_Affine_Tutorial_Result_Warp.jpg" alt=""/>
</div>
    <p>and finally, after applying a negative rotation (remember negative means clockwise) and a scale factor, we get:</p>
<div class="image">
<img src="../../Warp_Affine_Tutorial_Result_Warp_Rotate.jpg" alt=""/>
</div>
     </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jun 2 2024 21:52:14 for OpenCV by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.9.8
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>
</body>
</html>
