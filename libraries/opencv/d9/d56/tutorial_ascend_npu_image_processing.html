<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>OpenCV: Ascend NPU Image Processing</title>
<link href="../../opencv.ico" rel="shortcut icon" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../tutorial-utils.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  loader: {
    load: ['[tex]/ams']
  },
  tex: {
    macros: {},
    packages: ['base','configmacros','ams']
  }
};
//<![CDATA[
window.MathJax = {
    loader: {load: ['[tex]/ams']},
    tex: {
        packages: {'[+]': ['ams']},
        macros: {
            matTT: [ "\\[ \\left|\\begin{array}{ccc} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{array}\\right| \\]", 9],
            fork: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ \\end{array} \\right.", 4],
            forkthree: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ \\end{array} \\right.", 6],
            forkfour: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ #7 & \\mbox{#8}\\\\ \\end{array} \\right.", 8],
            vecthree: ["\\begin{bmatrix} #1\\\\ #2\\\\ #3 \\end{bmatrix}", 3],
            vecthreethree: ["\\begin{bmatrix} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{bmatrix}", 9],
            cameramatrix: ["#1 = \\begin{bmatrix} f_x & 0 & c_x\\\\ 0 & f_y & c_y\\\\ 0 & 0 & 1 \\end{bmatrix}", 1],
            distcoeffs: ["(k_1, k_2, p_1, p_2[, k_3[, k_4, k_5, k_6 [, s_1, s_2, s_3, s_4[, \\tau_x, \\tau_y]]]]) \\text{ of 4, 5, 8, 12 or 14 elements}"],
            distcoeffsfisheye: ["(k_1, k_2, k_3, k_4)"],
            hdotsfor: ["\\dots", 1],
            mathbbm: ["\\mathbb{#1}", 1],
            bordermatrix: ["\\matrix{#1}", 1]
        },
        processEscapes: false
    }
};
//]]>
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-chtml.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<!--#include virtual="/google-search.html"-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../opencv-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCV
   &#160;<span id="projectnumber">4.10.0</span>
   </div>
   <div id="projectbrief">Open Source Computer Vision</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d3/d81/tutorial_contrib_root.html">Tutorials for contrib modules</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Ascend NPU Image Processing</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1866"></a>
Goal</h1>
<p>In this guide, you will gain insights into the thread safety of Ascend operators already in use, as well as discover how to effectively employ Ascend operators for image preprocessing and understand their usage limitations.</p>
<h1><a class="anchor" id="autotoc_md1867"></a>
Preface</h1>
<p>We provide a suite of common matrix operation operators that support the <a href="https://www.hiascend.com/en/" target="_blank">Ascend NPU</a> within OpenCV. For user convenience, the new 'AscendMat' structure and its associated operators maintain compatibility with the 'Mat' interface in OpenCV. These operators encompass a wide range of frequently used functions, including arithmetic operations, image processing operations, and image color space conversion. All of these operators are implemented utilizing <a href="https://www.hiascend.com/en/software/cann" target="_blank">CANN</a>(Compute Architecture of Neural Networks). The Ascend operator facilitates accelerated operations on the NPU by making use of CANN. This acceleration effect is particularly noticeable when working with larger images, such as those with dimensions like 2048x2048, 3840x2160, 7680x4320, etc.</p>
<h1><a class="anchor" id="autotoc_md1868"></a>
Instructions on Thread Safety</h1>
<p>Our stream function is implemented by invoking the CANN operators. In the same stream, tasks are executed sequentially, while across different streams, tasks are executed in parallel. The use of event mechanisms ensures synchronization of tasks between streams, please refer to the <a href="https://www.hiascend.com/document/detail/en/CANNCommunityEdition/600alphaX/infacldevg/aclcppdevg/aclcppdevg_000147.html" target="_blank"><b>Stream Management</b></a> documentation for details.</p>
<h1><a class="anchor" id="autotoc_md1869"></a>
Example for Image Preprocessing</h1>
<p>In this section, you will discover how to use Ascend operators for image preprocessing, including functions below:</p>
<ul>
<li>Add</li>
<li>Rotate</li>
<li>Flip</li>
</ul>
<h2><a class="anchor" id="autotoc_md1870"></a>
code</h2>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line"><span class="comment">// This file is part of OpenCV project.</span></div>
<div class="line"><span class="comment">// It is subject to the license terms in the LICENSE file found in the top-level directory</span></div>
<div class="line"><span class="comment">// of this distribution and at http://opencv.org/license.html.</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d6/d87/imgcodecs_8hpp.html">opencv2/imgcodecs.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../de/de5/cann_8hpp.html">opencv2/cann.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d1/d22/cann__interface_8hpp.html">opencv2/cann_interface.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_class" href="../../d0/d2e/classcv_1_1CommandLineParser.html">cv::CommandLineParser</a> parser(argc, argv,</div>
<div class="line">                                 <span class="stringliteral">&quot;{@input|puppy.png|path to input image}&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;{@output|output.png|path to output image}&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;{help||show help}&quot;</span>);</div>
<div class="line">    parser.about(<span class="stringliteral">&quot;This is a sample for image processing with Ascend NPU. \n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (argc != 3 || parser.has(<span class="stringliteral">&quot;help&quot;</span>))</div>
<div class="line">    {</div>
<div class="line">        parser.printMessage();</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::string imagePath = parser.get&lt;std::string&gt;(0);</div>
<div class="line">    std::string outputPath = parser.get&lt;std::string&gt;(1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// read input image and generate guass noise</span></div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a> img = <a class="code hl_function" href="../../d4/da8/group__imgcodecs.html#gab32ee19e22660912565f8140d0f675a8">cv::imread</a>(imagePath);</div>
<div class="line">    <span class="comment">// Generate gauss noise that will be added into the input image</span></div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a> gaussNoise(img.rows, img.cols, img.type());</div>
<div class="line">    <a class="code hl_class" href="../../d1/dd6/classcv_1_1RNG.html">cv::RNG</a> rng;</div>
<div class="line">    rng.<a class="code hl_function" href="../../d1/dd6/classcv_1_1RNG.html#ad26f2b09d9868cf108e84c9814aa682d">fill</a>(gaussNoise, <a class="code hl_enumvalue" href="../../d1/dd6/classcv_1_1RNG.html#a47764cc2b25b6a104b54fe60078e3ccba85da6d7bc413e10a648f638151129a91">cv::RNG::NORMAL</a>, 0, 25);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// setup cann</span></div>
<div class="line">    <a class="code hl_function" href="../../d2/de9/group__cann__init.html#ga18f3a6f254b220d4a3fbc31c59abc2dd">cv::cann::initAcl</a>();</div>
<div class="line">    <a class="code hl_function" href="../../d2/de9/group__cann__init.html#gabc52559c0a95f0df82474e641f83b552">cv::cann::setDevice</a>(0);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a> output;</div>
<div class="line">    <span class="comment">// add gauss noise to the image</span></div>
<div class="line">    <a class="code hl_function" href="../../d5/d2b/group__cannops__elem.html#ga3c04ae982c391de61086edb26d6be28c">cv::cann::add</a>(img, gaussNoise, output);</div>
<div class="line">    <span class="comment">// rotate the image with a certain mode (0, 1 and 2, correspond to rotation of 90, 180 and 270</span></div>
<div class="line">    <span class="comment">// degrees clockwise respectively)</span></div>
<div class="line">    <a class="code hl_function" href="../../dd/d0c/group__cannops__core.html#ga0d3039c60f5a00f0c483868e4ef45545">cv::cann::rotate</a>(output, output, 0);</div>
<div class="line">    <span class="comment">// flip the image with a certain mode (0, positive and negative number, correspond to flipping</span></div>
<div class="line">    <span class="comment">// around the x-axis, y-axis and both axes respectively)</span></div>
<div class="line">    <a class="code hl_function" href="../../dd/d0c/group__cannops__core.html#gaec47906e7e3d0f07a000b7658aa6ec82">cv::cann::flip</a>(output, output, 0);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d4/da8/group__imgcodecs.html#ga8ac397bd09e48851665edbe12aa28f25">cv::imwrite</a>(outputPath, output);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="../../d2/de9/group__cann__init.html#ga0b9bf79f5d865c174656694dd6a8f0f6">cv::cann::resetDevice</a>();</div>
<div class="line">    <a class="code hl_function" href="../../d2/de9/group__cann__init.html#ga296b241e15fddf804c41471a75ea7b2c">cv::cann::finalizeAcl</a>();</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="acann_8hpp_html"><div class="ttname"><a href="../../de/de5/cann_8hpp.html">cann.hpp</a></div></div>
<div class="ttc" id="acann__interface_8hpp_html"><div class="ttname"><a href="../../d1/d22/cann__interface_8hpp.html">cann_interface.hpp</a></div></div>
<div class="ttc" id="aclasscv_1_1CommandLineParser_html"><div class="ttname"><a href="../../d0/d2e/classcv_1_1CommandLineParser.html">cv::CommandLineParser</a></div><div class="ttdoc">Designed for command line parsing.</div><div class="ttdef"><b>Definition</b> utility.hpp:820</div></div>
<div class="ttc" id="aclasscv_1_1Mat_html"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a></div><div class="ttdoc">n-dimensional dense array class</div><div class="ttdef"><b>Definition</b> mat.hpp:812</div></div>
<div class="ttc" id="aclasscv_1_1RNG_html"><div class="ttname"><a href="../../d1/dd6/classcv_1_1RNG.html">cv::RNG</a></div><div class="ttdoc">Random Number Generator.</div><div class="ttdef"><b>Definition</b> core.hpp:2889</div></div>
<div class="ttc" id="aclasscv_1_1RNG_html_a47764cc2b25b6a104b54fe60078e3ccba85da6d7bc413e10a648f638151129a91"><div class="ttname"><a href="../../d1/dd6/classcv_1_1RNG.html#a47764cc2b25b6a104b54fe60078e3ccba85da6d7bc413e10a648f638151129a91">cv::RNG::NORMAL</a></div><div class="ttdeci">@ NORMAL</div><div class="ttdef"><b>Definition</b> core.hpp:2892</div></div>
<div class="ttc" id="aclasscv_1_1RNG_html_ad26f2b09d9868cf108e84c9814aa682d"><div class="ttname"><a href="../../d1/dd6/classcv_1_1RNG.html#ad26f2b09d9868cf108e84c9814aa682d">cv::RNG::fill</a></div><div class="ttdeci">void fill(InputOutputArray mat, int distType, InputArray a, InputArray b, bool saturateRange=false)</div><div class="ttdoc">Fills arrays with random numbers.</div></div>
<div class="ttc" id="agroup__cann__init_html_ga0b9bf79f5d865c174656694dd6a8f0f6"><div class="ttname"><a href="../../d2/de9/group__cann__init.html#ga0b9bf79f5d865c174656694dd6a8f0f6">cv::cann::resetDevice</a></div><div class="ttdeci">void resetDevice()</div><div class="ttdoc">Clear all context created in current Ascend device.</div></div>
<div class="ttc" id="agroup__cann__init_html_ga18f3a6f254b220d4a3fbc31c59abc2dd"><div class="ttname"><a href="../../d2/de9/group__cann__init.html#ga18f3a6f254b220d4a3fbc31c59abc2dd">cv::cann::initAcl</a></div><div class="ttdeci">void initAcl()</div><div class="ttdoc">init AscendCL.</div></div>
<div class="ttc" id="agroup__cann__init_html_ga296b241e15fddf804c41471a75ea7b2c"><div class="ttname"><a href="../../d2/de9/group__cann__init.html#ga296b241e15fddf804c41471a75ea7b2c">cv::cann::finalizeAcl</a></div><div class="ttdeci">void finalizeAcl()</div><div class="ttdoc">finalize AscendCL.</div></div>
<div class="ttc" id="agroup__cann__init_html_gabc52559c0a95f0df82474e641f83b552"><div class="ttname"><a href="../../d2/de9/group__cann__init.html#gabc52559c0a95f0df82474e641f83b552">cv::cann::setDevice</a></div><div class="ttdeci">void setDevice(int device)</div><div class="ttdoc">Choose Ascend npu device.</div></div>
<div class="ttc" id="agroup__cannops__core_html_ga0d3039c60f5a00f0c483868e4ef45545"><div class="ttname"><a href="../../dd/d0c/group__cannops__core.html#ga0d3039c60f5a00f0c483868e4ef45545">cv::cann::rotate</a></div><div class="ttdeci">void rotate(InputArray src, OutputArray dst, int rotateCode, AscendStream &amp;stream=AscendStream::Null())</div><div class="ttdoc">Rotates a 2D array in multiples of 90 degrees. The function cv::rotate rotates the array in one of th...</div></div>
<div class="ttc" id="agroup__cannops__core_html_gaec47906e7e3d0f07a000b7658aa6ec82"><div class="ttname"><a href="../../dd/d0c/group__cannops__core.html#gaec47906e7e3d0f07a000b7658aa6ec82">cv::cann::flip</a></div><div class="ttdeci">void flip(InputArray src, OutputArray dst, int flipCode, AscendStream &amp;stream=AscendStream::Null())</div><div class="ttdoc">Flips a 2D matrix around vertical, horizontal, or both axes.</div></div>
<div class="ttc" id="agroup__cannops__elem_html_ga3c04ae982c391de61086edb26d6be28c"><div class="ttname"><a href="../../d5/d2b/group__cannops__elem.html#ga3c04ae982c391de61086edb26d6be28c">cv::cann::add</a></div><div class="ttdeci">void add(const InputArray src1, const InputArray src2, OutputArray dst, const InputArray mask=noArray(), int dtype=-1, AscendStream &amp;stream=AscendStream::Null())</div><div class="ttdoc">Computes a matrix-matrix or matrix-scalar sum.</div></div>
<div class="ttc" id="agroup__imgcodecs_html_ga8ac397bd09e48851665edbe12aa28f25"><div class="ttname"><a href="../../d4/da8/group__imgcodecs.html#ga8ac397bd09e48851665edbe12aa28f25">cv::imwrite</a></div><div class="ttdeci">CV_EXPORTS_W bool imwrite(const String &amp;filename, InputArray img, const std::vector&lt; int &gt; &amp;params=std::vector&lt; int &gt;())</div><div class="ttdoc">Saves an image to a specified file.</div></div>
<div class="ttc" id="agroup__imgcodecs_html_gab32ee19e22660912565f8140d0f675a8"><div class="ttname"><a href="../../d4/da8/group__imgcodecs.html#gab32ee19e22660912565f8140d0f675a8">cv::imread</a></div><div class="ttdeci">CV_EXPORTS_W Mat imread(const String &amp;filename, int flags=IMREAD_COLOR)</div><div class="ttdoc">Loads an image from a file.</div></div>
<div class="ttc" id="ahighgui__qt_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> highgui_qt.cpp:3</div></div>
<div class="ttc" id="aimgcodecs_8hpp_html"><div class="ttname"><a href="../../d6/d87/imgcodecs_8hpp.html">imgcodecs.hpp</a></div></div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line"><span class="comment"># This file is part of OpenCV project.</span></div>
<div class="line"><span class="comment"># It is subject to the license terms in the LICENSE file found in the top-level directory</span></div>
<div class="line"><span class="comment"># of this distribution and at http://opencv.org/license.html.</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><span class="keyword">import</span> cv2</div>
<div class="line"><span class="keyword">import</span> argparse</div>
<div class="line"> </div>
<div class="line">parser = argparse.ArgumentParser(description=<span class="stringliteral">&#39;This is a sample for image processing with Ascend NPU.&#39;</span>)</div>
<div class="line">parser.add_argument(<span class="stringliteral">&#39;image&#39;</span>, help=<span class="stringliteral">&#39;path to input image&#39;</span>)</div>
<div class="line">parser.add_argument(<span class="stringliteral">&#39;output&#39;</span>, help=<span class="stringliteral">&#39;path to output image&#39;</span>)</div>
<div class="line">args = parser.parse_args()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># read input image and generate guass noise</span></div>
<div class="line"><span class="comment">#! [input_noise]</span></div>
<div class="line">img = cv2.imread(args.image)</div>
<div class="line"><span class="comment"># Generate gauss noise that will be added into the input image</span></div>
<div class="line">gaussNoise = np.random.normal(0, 25,(img.shape[0], img.shape[1], img.shape[2])).astype(img.dtype)</div>
<div class="line"><span class="comment">#! [input_noise]</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># setup cann</span></div>
<div class="line"><span class="comment">#! [setup]</span></div>
<div class="line">cv2.cann.initAcl()</div>
<div class="line">cv2.cann.setDevice(0)</div>
<div class="line"><span class="comment">#! [setup]</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">#! [image-process]</span></div>
<div class="line"><span class="comment"># add gauss noise to the image</span></div>
<div class="line">output = cv2.cann.add(img, gaussNoise)</div>
<div class="line"><span class="comment"># rotate the image with a certain mode (0, 1 and 2, correspond to rotation of 90, 180</span></div>
<div class="line"><span class="comment"># and 270 degrees clockwise respectively)</span></div>
<div class="line">output = cv2.cann.rotate(output, 0)</div>
<div class="line"><span class="comment"># flip the image with a certain mode (0, positive and negative number, correspond to flipping</span></div>
<div class="line"><span class="comment"># around the x-axis, y-axis and both axes respectively)</span></div>
<div class="line">output = cv2.cann.flip(output, 0)</div>
<div class="line"><span class="comment">#! [image-process]</span></div>
<div class="line"> </div>
<div class="line">cv2.imwrite(args.output, output)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#! [tear-down-cann]</span></div>
<div class="line">cv2.cann.finalizeAcl()</div>
<div class="line"><span class="comment">#! [tear-down-cann]</span></div>
</div><!-- fragment -->  </div> <h2><a class="anchor" id="autotoc_md1871"></a>
Explanation</h2>
<p><b>Input Image</b></p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a> img = <a class="code hl_function" href="../../d4/da8/group__imgcodecs.html#gab32ee19e22660912565f8140d0f675a8">cv::imread</a>(imagePath);</div>
<div class="line">    <span class="comment">// Generate gauss noise that will be added into the input image</span></div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a> gaussNoise(img.rows, img.cols, img.type());</div>
<div class="line">    <a class="code hl_class" href="../../d1/dd6/classcv_1_1RNG.html">cv::RNG</a> rng;</div>
<div class="line">    rng.<a class="code hl_function" href="../../d1/dd6/classcv_1_1RNG.html#ad26f2b09d9868cf108e84c9814aa682d">fill</a>(gaussNoise, <a class="code hl_enumvalue" href="../../d1/dd6/classcv_1_1RNG.html#a47764cc2b25b6a104b54fe60078e3ccba85da6d7bc413e10a648f638151129a91">cv::RNG::NORMAL</a>, 0, 25);</div>
</div><!-- fragment -->  </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'><div class="fragment"><div class="line"><span class="comment"># Read the input image</span></div>
<div class="line">img = cv2.imread(<span class="stringliteral">&quot;/path/to/img&quot;</span>)</div>
<div class="line"><span class="comment"># Generate gauss noise that will be added into the input image</span></div>
<div class="line">gaussNoise = np.random.normal(mean=0,sigma=25,(img.shape[0],img.shape[1],img.shape[2])).astype(img.dtype)</div>
</div><!-- fragment --> </div> <p><b>Setup CANN</b></p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'><div class="fragment"><div class="line">    <a class="code hl_function" href="../../d2/de9/group__cann__init.html#ga18f3a6f254b220d4a3fbc31c59abc2dd">cv::cann::initAcl</a>();</div>
<div class="line">    <a class="code hl_function" href="../../d2/de9/group__cann__init.html#gabc52559c0a95f0df82474e641f83b552">cv::cann::setDevice</a>(0);</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'><div class="fragment"><div class="line">cv2.cann.initAcl()</div>
<div class="line">cv2.cann.setDevice(0)</div>
</div><!-- fragment --> </div> <p> <b>Image Preprocessing Example</b></p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'><div class="fragment"><div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a> output;</div>
<div class="line">    <span class="comment">// add gauss noise to the image</span></div>
<div class="line">    <a class="code hl_function" href="../../d5/d2b/group__cannops__elem.html#ga3c04ae982c391de61086edb26d6be28c">cv::cann::add</a>(img, gaussNoise, output);</div>
<div class="line">    <span class="comment">// rotate the image with a certain mode (0, 1 and 2, correspond to rotation of 90, 180 and 270</span></div>
<div class="line">    <span class="comment">// degrees clockwise respectively)</span></div>
<div class="line">    <a class="code hl_function" href="../../dd/d0c/group__cannops__core.html#ga0d3039c60f5a00f0c483868e4ef45545">cv::cann::rotate</a>(output, output, 0);</div>
<div class="line">    <span class="comment">// flip the image with a certain mode (0, positive and negative number, correspond to flipping</span></div>
<div class="line">    <span class="comment">// around the x-axis, y-axis and both axes respectively)</span></div>
<div class="line">    <a class="code hl_function" href="../../dd/d0c/group__cannops__core.html#gaec47906e7e3d0f07a000b7658aa6ec82">cv::cann::flip</a>(output, output, 0);</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'><div class="fragment"><div class="line"><span class="comment"># add gauss noise to the image</span></div>
<div class="line">output = cv2.cann.add(img, gaussNoise)</div>
<div class="line"><span class="comment"># rotate the image with a certain mode (0, 1 and 2, correspond to rotation of 90, 180</span></div>
<div class="line"><span class="comment"># and 270 degrees clockwise respectively)</span></div>
<div class="line">output = cv2.cann.rotate(output, 0)</div>
<div class="line"><span class="comment"># flip the image with a certain mode (0, positive and negative number, correspond to flipping</span></div>
<div class="line"><span class="comment"># around the x-axis, y-axis and both axes respectively)</span></div>
<div class="line">output = cv2.cann.flip(output, 0)</div>
</div><!-- fragment --> </div> <p><b>Tear down CANN</b></p>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code hl_function" href="../../d2/de9/group__cann__init.html#ga0b9bf79f5d865c174656694dd6a8f0f6">cv::cann::resetDevice</a>();</div>
<div class="line">    <a class="code hl_function" href="../../d2/de9/group__cann__init.html#ga296b241e15fddf804c41471a75ea7b2c">cv::cann::finalizeAcl</a>();</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'><div class="fragment"><div class="line">cv2.cann.finalizeAcl()</div>
</div><!-- fragment --> </div> <p> Results</p>
<ol type="1">
<li>The original RGB input image with dimensions of (480, 640, 3):</li>
</ol>
<div class="image">
<img src="../../puppy.jpg" alt=""/>
<div class="caption">
puppy</div></div>
    <ol type="1">
<li>After introducing Gaussian noise, we obtain the following result:</li>
</ol>
<div class="image">
<img src="../../puppy_noisy.jpg" alt=""/>
<div class="caption">
puppy_noisy</div></div>
    <ol type="1">
<li>When applying the rotate operation with a rotation code of 0 (90 degrees clockwise), we obtain this result:</li>
</ol>
<div class="image">
<img src="../../puppy_noisy_rotate.jpg" alt=""/>
<div class="caption">
puppy_noisy_rotate</div></div>
    <ol type="1">
<li>Upon applying the flip operation with a flip code of 0 (flipping around the x-axis), we achieve the final result:</li>
</ol>
<div class="image">
<img src="../../puppy_processed.jpg" alt=""/>
<div class="caption">
puppy_processed_normalized</div></div>
     </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jun 2 2024 21:52:14 for OpenCV by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.9.8
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>
</body>
</html>
