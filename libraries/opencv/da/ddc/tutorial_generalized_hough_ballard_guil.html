<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>OpenCV: Object detection with Generalized Ballard and Guil Hough Transform</title>
<link href="../../opencv.ico" rel="shortcut icon" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../tutorial-utils.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  },
  loader: {
    load: ['[tex]/ams']
  },
  tex: {
    macros: {},
    packages: ['base','configmacros','ams']
  }
};
//<![CDATA[
window.MathJax = {
    loader: {load: ['[tex]/ams']},
    tex: {
        packages: {'[+]': ['ams']},
        macros: {
            matTT: [ "\\[ \\left|\\begin{array}{ccc} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{array}\\right| \\]", 9],
            fork: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ \\end{array} \\right.", 4],
            forkthree: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ \\end{array} \\right.", 6],
            forkfour: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ #7 & \\mbox{#8}\\\\ \\end{array} \\right.", 8],
            vecthree: ["\\begin{bmatrix} #1\\\\ #2\\\\ #3 \\end{bmatrix}", 3],
            vecthreethree: ["\\begin{bmatrix} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{bmatrix}", 9],
            cameramatrix: ["#1 = \\begin{bmatrix} f_x & 0 & c_x\\\\ 0 & f_y & c_y\\\\ 0 & 0 & 1 \\end{bmatrix}", 1],
            distcoeffs: ["(k_1, k_2, p_1, p_2[, k_3[, k_4, k_5, k_6 [, s_1, s_2, s_3, s_4[, \\tau_x, \\tau_y]]]]) \\text{ of 4, 5, 8, 12 or 14 elements}"],
            distcoeffsfisheye: ["(k_1, k_2, k_3, k_4)"],
            hdotsfor: ["\\dots", 1],
            mathbbm: ["\\mathbb{#1}", 1],
            bordermatrix: ["\\matrix{#1}", 1]
        },
        processEscapes: false
    }
};
//]]>
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-chtml.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<!--#include virtual="/google-search.html"-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../opencv-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCV
   &#160;<span id="projectnumber">4.10.0</span>
   </div>
   <div id="projectbrief">Open Source Computer Vision</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/df8/tutorial_root.html">OpenCV Tutorials</a></li><li class="navelem"><a class="el" href="../../d7/da8/tutorial_table_of_content_imgproc.html">Image Processing (imgproc module)</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Object detection with Generalized Ballard and Guil Hough Transform</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md567">Goal</a></li>
<li class="level1"><a href="#autotoc_md568">Example</a><ul><li class="level2"><a href="#autotoc_md569">What does this program do?</a></li>
<li class="level2"><a href="#autotoc_md570">Code</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md571">Explanation</a><ul><li class="level2"><a href="#autotoc_md572">Load image, template and setup variables</a></li>
<li class="level2"><a href="#autotoc_md573">Setup parameters</a></li>
<li class="level2"><a href="#autotoc_md574">Run detection</a></li>
<li class="level2"><a href="#autotoc_md575">Draw results and show image</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md576">Result</a></li>
</ul>
</div>
<div class="textblock"><p><b>Prev Tutorial:</b> <a class="el" href="../../d4/d70/tutorial_hough_circle.html">Hough Circle Transform</a> <br  />
<b>Next Tutorial:</b> <a class="el" href="../../d1/da0/tutorial_remap.html">Remapping</a> <br  />
 </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight"></th><th class="markdownTableHeadLeft"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">Original author   </td><td class="markdownTableBodyLeft">Markus Heck    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">Compatibility   </td><td class="markdownTableBodyLeft">OpenCV &gt;= 3.4   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md567"></a>
Goal</h1>
<p>In this tutorial you will learn how to:</p>
<ul>
<li>Use <a class="el" href="../../dc/d46/classcv_1_1GeneralizedHoughBallard.html">cv::GeneralizedHoughBallard</a> and <a class="el" href="../../d3/d20/classcv_1_1GeneralizedHoughGuil.html">cv::GeneralizedHoughGuil</a> to detect an object</li>
</ul>
<h1><a class="anchor" id="autotoc_md568"></a>
Example</h1>
<h2><a class="anchor" id="autotoc_md569"></a>
What does this program do?</h2>
<ol type="1">
<li>Load the image and template</li>
</ol>
<p><img src="../../generalized_hough_mini_image.jpg" alt="" class="inline" title="image"/>     <img src="../../generalized_hough_mini_template.jpg" alt="" class="inline" title="template"/>    </p>
<ol type="1">
<li>Instantiate <a class="el" href="../../dc/d46/classcv_1_1GeneralizedHoughBallard.html">cv::GeneralizedHoughBallard</a> with the help of <code>createGeneralizedHoughBallard()</code></li>
<li>Instantiate <a class="el" href="../../d3/d20/classcv_1_1GeneralizedHoughGuil.html">cv::GeneralizedHoughGuil</a> with the help of <code>createGeneralizedHoughGuil()</code></li>
<li>Set the required parameters for both GeneralizedHough variants</li>
<li>Detect and show found results</li>
</ol>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Both variants can't be instantiated directly. Using the create methods is required.</li>
<li>Guil Hough is very slow. Calculating the results for the "mini" files used in this tutorial takes only a few seconds. With image and template in a higher resolution, as shown below, my notebook requires about 5 minutes to calculate a result.</li>
</ul>
</dd></dl>
<p><img src="../../generalized_hough_image.jpg" alt="" class="inline" title="image"/>     <img src="../../generalized_hough_template.jpg" alt="" class="inline" title="template"/>    </p>
<h2><a class="anchor" id="autotoc_md570"></a>
Code</h2>
<p>The complete code for this tutorial is shown below. </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d4/dd5/highgui_8hpp.html">opencv2/highgui.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d1/d4f/imgproc_2include_2opencv2_2imgproc_8hpp.html">opencv2/imgproc.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d2/d75/namespacecv.html">cv</a>;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>() {</div>
<div class="line"><span class="comment">//  load source image and grayscale template</span></div>
<div class="line">    samples::addSamplesDataSearchSubDirectory(<span class="stringliteral">&quot;doc/tutorials/imgproc/generalized_hough_ballard_guil&quot;</span>);</div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> image = imread(samples::findFile(<span class="stringliteral">&quot;images/generalized_hough_mini_image.jpg&quot;</span>));</div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> templ = imread(samples::findFile(<span class="stringliteral">&quot;images/generalized_hough_mini_template.jpg&quot;</span>), IMREAD_GRAYSCALE);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  create grayscale image</span></div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> grayImage;</div>
<div class="line">    cvtColor(image, grayImage, COLOR_RGB2GRAY);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  create variable for location, scale and rotation of detected templates</span></div>
<div class="line">    vector&lt;Vec4f&gt; positionBallard, positionGuil;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  template width and height</span></div>
<div class="line">    <span class="keywordtype">int</span> w = templ.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>;</div>
<div class="line">    <span class="keywordtype">int</span> h = templ.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  create ballard and set options</span></div>
<div class="line">    <a class="code hl_typedef" href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">Ptr&lt;GeneralizedHoughBallard&gt;</a> ballard = createGeneralizedHoughBallard();</div>
<div class="line">    ballard-&gt;setMinDist(10);</div>
<div class="line">    ballard-&gt;setLevels(360);</div>
<div class="line">    ballard-&gt;setDp(2);</div>
<div class="line">    ballard-&gt;setMaxBufferSize(1000);</div>
<div class="line">    ballard-&gt;setVotesThreshold(40);</div>
<div class="line"> </div>
<div class="line">    ballard-&gt;setCannyLowThresh(30);</div>
<div class="line">    ballard-&gt;setCannyHighThresh(110);</div>
<div class="line">    ballard-&gt;setTemplate(templ);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  create guil and set options</span></div>
<div class="line">    <a class="code hl_typedef" href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">Ptr&lt;GeneralizedHoughGuil&gt;</a> guil = createGeneralizedHoughGuil();</div>
<div class="line">    guil-&gt;setMinDist(10);</div>
<div class="line">    guil-&gt;setLevels(360);</div>
<div class="line">    guil-&gt;setDp(3);</div>
<div class="line">    guil-&gt;setMaxBufferSize(1000);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setMinAngle(0);</div>
<div class="line">    guil-&gt;setMaxAngle(360);</div>
<div class="line">    guil-&gt;setAngleStep(1);</div>
<div class="line">    guil-&gt;setAngleThresh(1500);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setMinScale(0.5);</div>
<div class="line">    guil-&gt;setMaxScale(2.0);</div>
<div class="line">    guil-&gt;setScaleStep(0.05);</div>
<div class="line">    guil-&gt;setScaleThresh(50);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setPosThresh(10);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setCannyLowThresh(30);</div>
<div class="line">    guil-&gt;setCannyHighThresh(110);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setTemplate(templ);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  execute ballard detection</span></div>
<div class="line">    ballard-&gt;detect(grayImage, positionBallard);</div>
<div class="line"><span class="comment">//  execute guil detection</span></div>
<div class="line">    guil-&gt;detect(grayImage, positionGuil);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  draw ballard</span></div>
<div class="line">    <span class="keywordflow">for</span> (vector&lt;Vec4f&gt;::iterator iter = positionBallard.begin(); iter != positionBallard.end(); ++iter) {</div>
<div class="line">        <a class="code hl_class" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a> rRect = <a class="code hl_class" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a>(<a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>((*iter)[0], (*iter)[1]),</div>
<div class="line">                                        <a class="code hl_class" href="../../d6/d50/classcv_1_1Size__.html">Size2f</a>(w * (*iter)[2], h * (*iter)[2]),</div>
<div class="line">                                        (*iter)[3]);</div>
<div class="line">        <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> vertices[4];</div>
<div class="line">        rRect.<a class="code hl_function" href="../../db/dd6/classcv_1_1RotatedRect.html#a69d648b086f26dbce0029facae9bfb2d">points</a>(vertices);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line">            line(image, vertices[i], vertices[(i + 1) % 4], <a class="code hl_class" href="../../d1/da0/classcv_1_1Scalar__.html">Scalar</a>(255, 0, 0), 6);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  draw guil</span></div>
<div class="line">    <span class="keywordflow">for</span> (vector&lt;Vec4f&gt;::iterator iter = positionGuil.begin(); iter != positionGuil.end(); ++iter) {</div>
<div class="line">        <a class="code hl_class" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a> rRect = <a class="code hl_class" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a>(<a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>((*iter)[0], (*iter)[1]),</div>
<div class="line">                                        <a class="code hl_class" href="../../d6/d50/classcv_1_1Size__.html">Size2f</a>(w * (*iter)[2], h * (*iter)[2]),</div>
<div class="line">                                        (*iter)[3]);</div>
<div class="line">        <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> vertices[4];</div>
<div class="line">        rRect.<a class="code hl_function" href="../../db/dd6/classcv_1_1RotatedRect.html#a69d648b086f26dbce0029facae9bfb2d">points</a>(vertices);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line">            line(image, vertices[i], vertices[(i + 1) % 4], <a class="code hl_class" href="../../d1/da0/classcv_1_1Scalar__.html">Scalar</a>(0, 255, 0), 2);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    imshow(<span class="stringliteral">&quot;result_img&quot;</span>, image);</div>
<div class="line">    waitKey();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="ttc" id="aclasscv_1_1Mat_html"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html">cv::Mat</a></div><div class="ttdoc">n-dimensional dense array class</div><div class="ttdef"><b>Definition</b> mat.hpp:812</div></div>
<div class="ttc" id="aclasscv_1_1Mat_html_aa3e5a47585c9ef6a0842556739155e3e"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cv::Mat::cols</a></div><div class="ttdeci">int cols</div><div class="ttdef"><b>Definition</b> mat.hpp:2138</div></div>
<div class="ttc" id="aclasscv_1_1Mat_html_abed816466c45234254d25bc59c31245e"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">cv::Mat::rows</a></div><div class="ttdeci">int rows</div><div class="ttdoc">the number of rows and columns or (-1, -1) when the matrix has more than 2 dimensions</div><div class="ttdef"><b>Definition</b> mat.hpp:2138</div></div>
<div class="ttc" id="aclasscv_1_1Point___html"><div class="ttname"><a href="../../db/d4e/classcv_1_1Point__.html">cv::Point_&lt; float &gt;</a></div></div>
<div class="ttc" id="aclasscv_1_1RotatedRect_html"><div class="ttname"><a href="../../db/dd6/classcv_1_1RotatedRect.html">cv::RotatedRect</a></div><div class="ttdoc">The class represents rotated (i.e. not up-right) rectangles on a plane.</div><div class="ttdef"><b>Definition</b> types.hpp:531</div></div>
<div class="ttc" id="aclasscv_1_1RotatedRect_html_a69d648b086f26dbce0029facae9bfb2d"><div class="ttname"><a href="../../db/dd6/classcv_1_1RotatedRect.html#a69d648b086f26dbce0029facae9bfb2d">cv::RotatedRect::points</a></div><div class="ttdeci">void points(Point2f pts[]) const</div></div>
<div class="ttc" id="aclasscv_1_1Scalar___html"><div class="ttname"><a href="../../d1/da0/classcv_1_1Scalar__.html">cv::Scalar_&lt; double &gt;</a></div></div>
<div class="ttc" id="aclasscv_1_1Size___html"><div class="ttname"><a href="../../d6/d50/classcv_1_1Size__.html">cv::Size_&lt; float &gt;</a></div></div>
<div class="ttc" id="agroup__core__basic_html_ga6395ca871a678020c4a31fadf7e8cc63"><div class="ttname"><a href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">cv::Ptr</a></div><div class="ttdeci">std::shared_ptr&lt; _Tp &gt; Ptr</div><div class="ttdef"><b>Definition</b> cvstd_wrapper.hpp:23</div></div>
<div class="ttc" id="ahighgui_8hpp_html"><div class="ttname"><a href="../../d4/dd5/highgui_8hpp.html">highgui.hpp</a></div></div>
<div class="ttc" id="ahighgui__qt_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> highgui_qt.cpp:3</div></div>
<div class="ttc" id="aimgproc_2include_2opencv2_2imgproc_8hpp_html"><div class="ttname"><a href="../../d1/d4f/imgproc_2include_2opencv2_2imgproc_8hpp.html">imgproc.hpp</a></div></div>
<div class="ttc" id="anamespacecv_html"><div class="ttname"><a href="../../d2/d75/namespacecv.html">cv</a></div><div class="ttdoc">&quot;black box&quot; representation of the file storage associated with a file on disk.</div><div class="ttdef"><b>Definition</b> core.hpp:102</div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div><div class="ttdoc">STL namespace.</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md571"></a>
Explanation</h1>
<h2><a class="anchor" id="autotoc_md572"></a>
Load image, template and setup variables</h2>
<div class="fragment"><div class="line"><span class="comment">//  load source image and grayscale template</span></div>
<div class="line">    samples::addSamplesDataSearchSubDirectory(<span class="stringliteral">&quot;doc/tutorials/imgproc/generalized_hough_ballard_guil&quot;</span>);</div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> image = imread(samples::findFile(<span class="stringliteral">&quot;images/generalized_hough_mini_image.jpg&quot;</span>));</div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> templ = imread(samples::findFile(<span class="stringliteral">&quot;images/generalized_hough_mini_template.jpg&quot;</span>), IMREAD_GRAYSCALE);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  create grayscale image</span></div>
<div class="line">    <a class="code hl_class" href="../../d3/d63/classcv_1_1Mat.html">Mat</a> grayImage;</div>
<div class="line">    cvtColor(image, grayImage, COLOR_RGB2GRAY);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  create variable for location, scale and rotation of detected templates</span></div>
<div class="line">    vector&lt;Vec4f&gt; positionBallard, positionGuil;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  template width and height</span></div>
<div class="line">    <span class="keywordtype">int</span> w = templ.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#aa3e5a47585c9ef6a0842556739155e3e">cols</a>;</div>
<div class="line">    <span class="keywordtype">int</span> h = templ.<a class="code hl_variable" href="../../d3/d63/classcv_1_1Mat.html#abed816466c45234254d25bc59c31245e">rows</a>;</div>
</div><!-- fragment --><p>The position vectors will contain the matches the detectors will find. Every entry contains four floating point values: position vector</p>
<ul>
<li><em>[0]</em>: x coordinate of center point</li>
<li><em>[1]</em>: y coordinate of center point</li>
<li><em>[2]</em>: scale of detected object compared to template</li>
<li><em>[3]</em>: rotation of detected object in degree in relation to template</li>
</ul>
<p>An example could look as follows: <code>[200, 100, 0.9, 120]</code></p>
<h2><a class="anchor" id="autotoc_md573"></a>
Setup parameters</h2>
<div class="fragment"><div class="line"><span class="comment">//  create ballard and set options</span></div>
<div class="line">    <a class="code hl_typedef" href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">Ptr&lt;GeneralizedHoughBallard&gt;</a> ballard = createGeneralizedHoughBallard();</div>
<div class="line">    ballard-&gt;setMinDist(10);</div>
<div class="line">    ballard-&gt;setLevels(360);</div>
<div class="line">    ballard-&gt;setDp(2);</div>
<div class="line">    ballard-&gt;setMaxBufferSize(1000);</div>
<div class="line">    ballard-&gt;setVotesThreshold(40);</div>
<div class="line"> </div>
<div class="line">    ballard-&gt;setCannyLowThresh(30);</div>
<div class="line">    ballard-&gt;setCannyHighThresh(110);</div>
<div class="line">    ballard-&gt;setTemplate(templ);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//  create guil and set options</span></div>
<div class="line">    <a class="code hl_typedef" href="../../dc/d84/group__core__basic.html#ga6395ca871a678020c4a31fadf7e8cc63">Ptr&lt;GeneralizedHoughGuil&gt;</a> guil = createGeneralizedHoughGuil();</div>
<div class="line">    guil-&gt;setMinDist(10);</div>
<div class="line">    guil-&gt;setLevels(360);</div>
<div class="line">    guil-&gt;setDp(3);</div>
<div class="line">    guil-&gt;setMaxBufferSize(1000);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setMinAngle(0);</div>
<div class="line">    guil-&gt;setMaxAngle(360);</div>
<div class="line">    guil-&gt;setAngleStep(1);</div>
<div class="line">    guil-&gt;setAngleThresh(1500);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setMinScale(0.5);</div>
<div class="line">    guil-&gt;setMaxScale(2.0);</div>
<div class="line">    guil-&gt;setScaleStep(0.05);</div>
<div class="line">    guil-&gt;setScaleThresh(50);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setPosThresh(10);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setCannyLowThresh(30);</div>
<div class="line">    guil-&gt;setCannyHighThresh(110);</div>
<div class="line"> </div>
<div class="line">    guil-&gt;setTemplate(templ);</div>
</div><!-- fragment --><p>Finding the optimal values can end up in trial and error and depends on many factors, such as the image resolution.</p>
<h2><a class="anchor" id="autotoc_md574"></a>
Run detection</h2>
<div class="fragment"><div class="line"><span class="comment">//  execute ballard detection</span></div>
<div class="line">    ballard-&gt;detect(grayImage, positionBallard);</div>
<div class="line"><span class="comment">//  execute guil detection</span></div>
<div class="line">    guil-&gt;detect(grayImage, positionGuil);</div>
</div><!-- fragment --><p>As mentioned above, this step will take some time, especially with larger images and when using Guil.</p>
<h2><a class="anchor" id="autotoc_md575"></a>
Draw results and show image</h2>
<div class="fragment"><div class="line"><span class="comment">//  draw ballard</span></div>
<div class="line">    <span class="keywordflow">for</span> (vector&lt;Vec4f&gt;::iterator iter = positionBallard.begin(); iter != positionBallard.end(); ++iter) {</div>
<div class="line">        <a class="code hl_class" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a> rRect = <a class="code hl_class" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a>(<a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>((*iter)[0], (*iter)[1]),</div>
<div class="line">                                        <a class="code hl_class" href="../../d6/d50/classcv_1_1Size__.html">Size2f</a>(w * (*iter)[2], h * (*iter)[2]),</div>
<div class="line">                                        (*iter)[3]);</div>
<div class="line">        <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> vertices[4];</div>
<div class="line">        rRect.<a class="code hl_function" href="../../db/dd6/classcv_1_1RotatedRect.html#a69d648b086f26dbce0029facae9bfb2d">points</a>(vertices);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line">            line(image, vertices[i], vertices[(i + 1) % 4], <a class="code hl_class" href="../../d1/da0/classcv_1_1Scalar__.html">Scalar</a>(255, 0, 0), 6);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="comment">//  draw guil</span></div>
<div class="line">    <span class="keywordflow">for</span> (vector&lt;Vec4f&gt;::iterator iter = positionGuil.begin(); iter != positionGuil.end(); ++iter) {</div>
<div class="line">        <a class="code hl_class" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a> rRect = <a class="code hl_class" href="../../db/dd6/classcv_1_1RotatedRect.html">RotatedRect</a>(<a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a>((*iter)[0], (*iter)[1]),</div>
<div class="line">                                        <a class="code hl_class" href="../../d6/d50/classcv_1_1Size__.html">Size2f</a>(w * (*iter)[2], h * (*iter)[2]),</div>
<div class="line">                                        (*iter)[3]);</div>
<div class="line">        <a class="code hl_class" href="../../db/d4e/classcv_1_1Point__.html">Point2f</a> vertices[4];</div>
<div class="line">        rRect.<a class="code hl_function" href="../../db/dd6/classcv_1_1RotatedRect.html#a69d648b086f26dbce0029facae9bfb2d">points</a>(vertices);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line">            line(image, vertices[i], vertices[(i + 1) % 4], <a class="code hl_class" href="../../d1/da0/classcv_1_1Scalar__.html">Scalar</a>(0, 255, 0), 2);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    imshow(<span class="stringliteral">&quot;result_img&quot;</span>, image);</div>
<div class="line">    waitKey();</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md576"></a>
Result</h1>
<div class="image">
<img src="../../generalized_hough_result_img.jpg" alt=""/>
<div class="caption">
result image</div></div>
    <p>The blue rectangle shows the result of <a class="el" href="../../dc/d46/classcv_1_1GeneralizedHoughBallard.html">cv::GeneralizedHoughBallard</a> and the green rectangles the results of <a class="el" href="../../d3/d20/classcv_1_1GeneralizedHoughGuil.html">cv::GeneralizedHoughGuil</a>.</p>
<p>Getting perfect results like in this example is unlikely if the parameters are not perfectly adapted to the sample. An example with less perfect parameters is shown below. For the Ballard variant, only the center of the result is marked as a black dot on this image. The rectangle would be the same as on the previous image.</p>
<div class="image">
<img src="../../generalized_hough_less_perfect_result_img.jpg" alt=""/>
<div class="caption">
less perfect result</div></div>
     </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jun 2 2024 21:52:13 for OpenCV by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.9.8
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>
</body>
</html>
